From ef3e7f5dd84271014965fa8ae30ac09223c11155 Mon Sep 17 00:00:00 2001
From: Vicki Pfau <vi@endrift.com>
Date: Mon, 22 Apr 2024 16:42:42 -0700
Subject: [PATCH 1/2] Add systemd service

---
 Makefile        | 3 +++
 systemd.service | 6 ++++++
 2 files changed, 9 insertions(+)
 create mode 100644 systemd.service

diff --git a/Makefile b/Makefile
index 7a7a661..791c5c5 100644
--- a/Makefile
+++ b/Makefile
@@ -24,6 +24,9 @@ clean:
 install: all LICENSE
 	install -D -m 755 wakehook $(DESTDIR)/usr/lib/hwsupport/wakehook
 	install -D -m 644 LICENSE $(DESTDIR)/usr/share/licenses/wakehook
+	install -D -m 644 systemd.service $(DESTDIR)/usr/lib/systemd/user/wakehook.service
+	mkdir -p $(DESTDIR)/usr/lib/systemd/user/gamescope-session.service.wants
+	ln -s ../wakehook.service $(DESTDIR)/usr/lib/systemd/user/gamescope-session.service.wants/
 
 wakehook: wakehook.o
 	$(CC) $(SDBUS_LDFLAGS) $(LDFLAGS) -o $@ $^
diff --git a/systemd.service b/systemd.service
new file mode 100644
index 0000000..7605916
--- /dev/null
+++ b/systemd.service
@@ -0,0 +1,6 @@
+[Unit]
+After=gamescope-session.service
+
+[Service]
+ExecStart=/usr/lib/hwsupport/wakehook
+Restart=always
-- 
2.44.0


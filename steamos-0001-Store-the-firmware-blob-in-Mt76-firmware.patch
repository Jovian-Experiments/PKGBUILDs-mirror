From 3b895f379c58590324a319736891cf15a26b18a1 Mon Sep 17 00:00:00 2001
From: Emil Velikov <emil.velikov@collabora.com>
Date: Mon, 17 May 2021 10:39:39 +0100
Subject: [PATCH 1/5] Store the firmware blob in Mt76::firmware

Signed-off-by: Emil Velikov <emil.velikov@collabora.com>
---
 dongle/mt76.cpp | 2 +-
 dongle/mt76.h   | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/dongle/mt76.cpp b/dongle/mt76.cpp
index af32484..55232f4 100644
--- a/dongle/mt76.cpp
+++ b/dongle/mt76.cpp
@@ -1450,7 +1450,7 @@ bool Mt76::loadFirmware()
     controlWrite(MT_FCE_PDMA_GLOBAL_CONF, 0x44);
     controlWrite(MT_FCE_SKIP_FS, 0x03);
 
-    const Bytes firmware(
+    firmware = Bytes(
         _binary_firmware_bin_start,
         _binary_firmware_bin_end
     );
diff --git a/dongle/mt76.h b/dongle/mt76.h
index c3bfce8..9eed764 100644
--- a/dongle/mt76.h
+++ b/dongle/mt76.h
@@ -572,6 +572,7 @@ private:
     Bytes efuseRead(uint8_t address, uint8_t index);
 
     uint16_t connectedClients = 0;
+    Bytes firmware;
 };
 
 class Mt76Exception : public std::runtime_error
-- 
2.32.0

